define(["angular","devConfig","pathConfig","jquery"],function(e){e.module("ppt-game-module",[]).controller("ppt-game-ctrl",["$scope","$location","$$console","$timeout","$interval","$$ls","$q",function(i,t,n,l,a){var o=i._f,r=i.s={timeSpend:0,"ppt-page-num":"ppt-page-num-1"};o.pageSlideLeft().nextPageAnimate().pageSlideRight(),o.alert("建议直接点击“开始”试试吧～～");var s=(new Date).getTime(),p=a(function(){var e=(new Date).getTime()-s;r.timeSpend=Math.floor(e/1e3);var i=parseInt(r.timeSpend/30%10)+1;r["ppt-page-num"]="ppt-page-"+i},1e3);i._s.title="细胞机器人";var c=i.t={cellRow:80,cellCol:100,itvTimePre:100,itvTime:100,cells:[],oneRow:[],setItvTime:function(){c.itvTime=c.itvTimePre,c.spawnPause(),c.spawnBegin()},initCells:function(){for(var i=0;i<this.cellCol;i++)this.oneRow[i]={alive:!1};for(var t=0;t<this.cellRow;t++)this.cells[t]=e.copy(this.oneRow)},alive:function(i,t){return e.isNumber(i)&&e.isNumber(t)&&(this.cells[i][t].alive=!0),this},die:function(i,t){return e.isNumber(i)&&e.isNumber(t)&&(this.cells[i][t].alive=!1),this},putPointGroup:function(e,i,t){e=e||[0,0],i=i||10,t=t||10;for(var n=0;n<e.length;n+=2){var l=e[n]+i,a=e[n+1]+t;this.alive(l,a)}},makeBeehive:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,1,0,2,1,0,1,3,2,1,2,2],e,i)},makeGlinder:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,1,1,2,2,0,2,1,2,2],e,i)},makeBeacon:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,0,0,1,1,0,1,1,2,2,2,3,3,2,3,3],e,i)},makeLWSS:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,0,0,3,1,4,2,0,2,4,3,1,3,2,3,3,3,4],e,i)},makeBlock:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,0,0,1,1,0,1,1],e,i)},makeGliderGun:function(e,i){e=e||10,i=i||10,this.putPointGroup([0,24,1,22,1,24,2,12,2,13,2,20,2,21,2,34,2,35,3,11,3,15,3,20,3,21,3,34,3,35,4,0,4,1,4,10,4,16,4,20,4,21,5,0,5,1,5,10,5,14,5,16,5,17,5,22,5,24,6,10,6,16,6,24,7,11,7,15,8,12,8,13],e,i)},judgeLive:function(e,i){var t=0,n=this.cells,l=n[e][i].alive,a=this.cellRow,o=this.cellCol;1==n[e][(i-1+o)%o].alive&&t++,1==n[e][(i+1)%o].alive&&t++,1==n[(e-1+a)%a][i].alive&&t++,1==n[(e+1)%a][i].alive&&t++,1==n[(e+1)%a][(i+1)%o].alive&&t++,1==n[(e-1+a)%a][(i+1)%o].alive&&t++,1==n[(e+1)%a][(i-1+o)%o].alive&&t++,1==n[(e-1+a)%a][(i-1+o)%o].alive&&t++,1==l&&(2>t||t>3)&&(n[e][i].prepareToLive=!1),0==l&&3==t&&(n[e][i].prepareToLive=!0)},nextStep:function(){for(var e=0;e<c.cells.length;e++)for(var i=c.cells[e],t=0;t<i.length;t++)c.judgeLive(e,t);for(var n=0;n<c.cells.length;n++)for(var l=c.cells[n],a=0;a<l.length;a++){var o=c.cells[n][a].prepareToLive;o===!1?c.die(n,a):o===!0&&c.alive(n,a),c.cells[n][a].prepareToLive=void 0}},pattern:"Point",clickCell:function(i,t){"Point"===c.pattern?e.isNumber(i)&&e.isNumber(t)&&c.cells[i][t].alive?c.die(i,t):c.alive(i,t):c["make"+c.pattern](i,t)},itv2:void 0,spawnBegin:function(){c.itv2=a(function(){c.nextStep()},c.itvTime)},spawnPause:function(){a.cancel(c.itv2)},spawnReset:function(){c.spawnPause();for(var e=0;e<c.cells.length;e++)for(var i=c.cells[e],t=0;t<i.length;t++)c.die(e,t)}};i.clickCell=c.clickCell,i.nextStep=c.nextStep,i.spawnBegin=c.spawnBegin,i.spawnPause=c.spawnPause,i.spawnReset=c.spawnReset,i.toWelcome=function(){t.path("/welcome")},c.initCells(),c.makeGlinder(5,35),c.makeLWSS(20,26),c.makeBlock(20,55),i.$on("$destroy",function(){a.cancel(p),a.cancel(c.itv2)})}])});